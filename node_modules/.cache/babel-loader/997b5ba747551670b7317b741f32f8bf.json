{"ast":null,"code":"var __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\nimport { mergeObject } from '../../utils/mergeObject.js';\nimport { initialRemoteConfig } from './initialConfig.js';\nexport const MemoryStorage = {\n  items: {},\n  getItem(key) {\n    var _a;\n    return __awaiter(this, void 0, void 0, function* () {\n      return (_a = MemoryStorage.items[key]) !== null && _a !== void 0 ? _a : null;\n    });\n  },\n  setItem(key, value) {\n    return __awaiter(this, void 0, void 0, function* () {\n      MemoryStorage.items[key] = value;\n    });\n  }\n};\nexport class UIKitConfigManager {\n  constructor(storage) {\n    this.storage = storage !== null && storage !== void 0 ? storage : MemoryStorage;\n  }\n  init(appId) {\n    this.key = \"sbu@\".concat(appId, \".uikitConfiguration\");\n    return this.get();\n  }\n  get safeKey() {\n    if (!this.key) throw new Error('Please UIKitConfigManager.init() first');\n    return this.key;\n  }\n  update(remoteConfigPayload) {\n    return __awaiter(this, void 0, void 0, function* () {\n      const storedConfigPayload = yield this.get();\n      const mergedConfigPayload = {\n        updatedAt: remoteConfigPayload.updatedAt,\n        configuration: mergeObject(storedConfigPayload.configuration, remoteConfigPayload.configuration)\n      };\n      yield this.storage.setItem(this.safeKey, JSON.stringify(mergedConfigPayload));\n      return mergedConfigPayload;\n    });\n  }\n  get() {\n    return __awaiter(this, void 0, void 0, function* () {\n      const initialPayload = {\n        updatedAt: 0,\n        configuration: initialRemoteConfig\n      };\n      try {\n        const storedConfig = yield this.storage.getItem(this.safeKey);\n        if (storedConfig) {\n          // TODO: Validation\n          return JSON.parse(storedConfig);\n        } else {\n          return initialPayload;\n        }\n      } catch (_a) {\n        return initialPayload;\n      }\n    });\n  }\n}","map":{"version":3,"names":["__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","mergeObject","initialRemoteConfig","MemoryStorage","items","getItem","key","_a","setItem","UIKitConfigManager","constructor","storage","init","appId","concat","get","safeKey","Error","update","remoteConfigPayload","storedConfigPayload","mergedConfigPayload","updatedAt","configuration","JSON","stringify","initialPayload","storedConfig","parse"],"sources":["D:/ebgbot/node_modules/@sendbird/uikit-react/node_modules/@sendbird/uikit-tools/dist/esm/uikitConfiguration/internal/configManager.js"],"sourcesContent":["var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { mergeObject } from '../../utils/mergeObject.js';\nimport { initialRemoteConfig } from './initialConfig.js';\nexport const MemoryStorage = {\n    items: {},\n    getItem(key) {\n        var _a;\n        return __awaiter(this, void 0, void 0, function* () {\n            return (_a = MemoryStorage.items[key]) !== null && _a !== void 0 ? _a : null;\n        });\n    },\n    setItem(key, value) {\n        return __awaiter(this, void 0, void 0, function* () {\n            MemoryStorage.items[key] = value;\n        });\n    },\n};\nexport class UIKitConfigManager {\n    constructor(storage) {\n        this.storage = storage !== null && storage !== void 0 ? storage : MemoryStorage;\n    }\n    init(appId) {\n        this.key = `sbu@${appId}.uikitConfiguration`;\n        return this.get();\n    }\n    get safeKey() {\n        if (!this.key)\n            throw new Error('Please UIKitConfigManager.init() first');\n        return this.key;\n    }\n    update(remoteConfigPayload) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const storedConfigPayload = yield this.get();\n            const mergedConfigPayload = {\n                updatedAt: remoteConfigPayload.updatedAt,\n                configuration: mergeObject(storedConfigPayload.configuration, remoteConfigPayload.configuration),\n            };\n            yield this.storage.setItem(this.safeKey, JSON.stringify(mergedConfigPayload));\n            return mergedConfigPayload;\n        });\n    }\n    get() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const initialPayload = {\n                updatedAt: 0,\n                configuration: initialRemoteConfig,\n            };\n            try {\n                const storedConfig = yield this.storage.getItem(this.safeKey);\n                if (storedConfig) {\n                    // TODO: Validation\n                    return JSON.parse(storedConfig);\n                }\n                else {\n                    return initialPayload;\n                }\n            }\n            catch (_a) {\n                return initialPayload;\n            }\n        });\n    }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}